import{a as Y}from"./chunk-QIO7KIZY.js";import{e as U,g as z,m as M,n as G,q as J,r as W,s as X}from"./chunk-MVBVP6EX.js";import{B as K,D as Q,n as L,w as H,x as q}from"./chunk-EH6KWEWP.js";import{j as A,k as F,m as j,o as R}from"./chunk-PD4PNQEU.js";import{$ as T,Cb as _,Db as S,E as I,Eb as B,Fb as V,J as w,Nb as c,Oa as p,Ob as d,Ta as h,Za as D,_ as E,a as y,b as O,cb as N,k as $,ob as g,pa as m,pb as a,qa as b,qb as s,rb as x,sb as C,tb as u,ub as l,w as f,x as P}from"./chunk-SEEG46KC.js";function te(r,o){r&1&&(a(0,"div",3),x(1,"i",4),_(2," Loading notebook... "),s())}function oe(r,o){r&1&&(a(0,"div",18)(1,"div",19),x(2,"i",20),s(),a(3,"h2"),_(4,"This notebook is empty"),s(),a(5,"p"),_(6,"Add some notes to this notebook to get started!"),s()())}function ne(r,o){if(r&1&&(a(0,"div",18)(1,"div",19),x(2,"i",21),s(),a(3,"h2"),_(4,"No notes found"),s(),a(5,"p"),_(6,' No notes in this notebook match your search for "'),a(7,"strong"),_(8),c(9,"async"),s(),_(10,'" '),s()()),r&2){let e=l(2);p(8),S(d(9,1,e.searchTerm$))}}function ie(r,o){if(r&1){let e=C();a(0,"app-note",28),u("open",function(n){m(e);let i=l(4);return b(i.openNote(n))})("delete",function(n){m(e);let i=l(4);return b(i.deleteNote(n))})("togglePin",function(n){m(e);let i=l(4);return b(i.togglePin(n.note,n.event))})("optionSelected",function(n){let i=m(e).$implicit,v=l(4);return b(v.handleNoteOption(n,i))}),s()}if(r&2){let e=o.$implicit;g("note",e)("showNotebook",!1)}}function re(r,o){if(r&1&&(a(0,"div",24)(1,"div",25)(2,"h2",10),_(3,"PINNED"),s()(),a(4,"div",26),N(5,ie,1,2,"app-note",27),c(6,"async"),s()()),r&2){let e=l(3);p(5),g("ngForOf",d(6,2,e.pinnedNotesInNotebook$))("ngForTrackBy",e.trackByNoteId)}}function se(r,o){if(r&1){let e=C();a(0,"app-note",28),u("open",function(n){m(e);let i=l(4);return b(i.openNote(n))})("delete",function(n){m(e);let i=l(4);return b(i.deleteNote(n))})("togglePin",function(n){m(e);let i=l(4);return b(i.togglePin(n.note,n.event))})("optionSelected",function(n){let i=m(e).$implicit,v=l(4);return b(v.handleNoteOption(n,i))}),s()}if(r&2){let e=o.$implicit;g("note",e)("showNotebook",!1)}}function ae(r,o){if(r&1&&(a(0,"div",24)(1,"div",25)(2,"h2",10),_(3),c(4,"async"),s()(),a(5,"div",26),N(6,se,1,2,"app-note",27),c(7,"async"),s()()),r&2){let e=l(3);p(3),B(" ",d(4,3,e.hasPinnedNotesInNotebook$)?"OTHER NOTES":"NOTES"," "),p(3),g("ngForOf",d(7,5,e.unpinnedNotesInNotebook$))("ngForTrackBy",e.trackByNoteId)}}function le(r,o){if(r&1&&(a(0,"div",22),N(1,re,7,4,"div",23),c(2,"async"),N(3,ae,8,7,"div",23),c(4,"async"),s()),r&2){let e=l(2);p(),g("ngIf",d(2,2,e.hasPinnedNotesInNotebook$)),p(2),g("ngIf",d(4,4,e.hasUnpinnedNotesInNotebook$))}}function ce(r,o){if(r&1){let e=C();a(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"h1",9),_(5),s(),a(6,"h2",10),_(7),s()(),a(8,"div",11)(9,"app-button-feature",12),u("clicked",function(){let n=m(e).ngIf,i=l();return b(i.editNotebook(n))}),s(),a(10,"app-button-feature",13),u("clicked",function(){let n=m(e).ngIf,i=l();return b(i.deleteNotebook(n))}),s(),a(11,"button",14),u("click",function(){m(e);let n=l();return b(n.navigateBack())}),x(12,"i",15),_(13," Close "),s()()()(),N(14,oe,7,0,"div",16)(15,ne,11,3,"div",16),c(16,"async"),c(17,"async"),c(18,"async"),c(19,"async"),N(20,le,5,6,"div",17),c(21,"async"),c(22,"async"),s()}if(r&2){let e=o.ngIf,t=l();p(5),S(e.name),p(2),V(" ",e.notes.length," ",e.notes.length<=1?"NOTE":"NOTES"," "),p(7),g("ngIf",e.notes.length===0),p(),g("ngIf",e.notes.length>0&&d(16,6,t.searchTerm$)&&d(17,8,t.searchTerm$).trim().length>0&&!d(18,10,t.hasPinnedNotesInNotebook$)&&!d(19,12,t.hasUnpinnedNotesInNotebook$)),p(5),g("ngIf",d(21,14,t.hasPinnedNotesInNotebook$)||d(22,16,t.hasUnpinnedNotesInNotebook$))}}var Z=class r{constructor(o,e,t,n){this.route=o;this.router=e;this.store=t;this.eventBus=n}notebook$;allNotes$;searchTerm$;pinnedNotesInNotebook$;unpinnedNotesInNotebook$;hasPinnedNotesInNotebook$;hasUnpinnedNotesInNotebook$;notFound=!1;openNotebookOptionsId=null;destroy$=new $;ngOnInit(){this.allNotes$=this.store.select(K),this.searchTerm$=this.store.select(Q),this.notebook$=P([this.route.params,this.store.select(J),this.allNotes$]).pipe(f(([e,t,n])=>{let i=t.find(k=>k.id===e.id);if(!i&&t.length>0){this.notFound=!0;return}if(!i)return;let v=i.notes.map(k=>n.find(ee=>ee.id===k.id)||k).filter(k=>!!k);return O(y({},i),{notes:v})}),T(e=>{e&&console.log("Final notebook with notes:",e.notes.length)}),E(this.destroy$));let o=P([this.notebook$,this.searchTerm$]).pipe(f(([e,t])=>e?t.trim()?e.notes.filter(n=>n.title.toLowerCase().includes(t.toLowerCase())||n.content.toLowerCase().includes(t.toLowerCase())):e.notes:[]));this.pinnedNotesInNotebook$=o.pipe(f(e=>e.filter(t=>t.pinned))),this.unpinnedNotesInNotebook$=o.pipe(f(e=>e.filter(t=>!t.pinned))),this.hasPinnedNotesInNotebook$=this.pinnedNotesInNotebook$.pipe(f(e=>e.length>0)),this.hasUnpinnedNotesInNotebook$=this.unpinnedNotesInNotebook$.pipe(f(e=>e.length>0))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}trackByNoteId(o,e){return e.id}editNotebook(o){this.startEditingNotebook(o)}startEditingNotebook(o){this.openNotebookOptionsId=null,this.eventBus.emitNotebookEdit(o)}deleteNotebook(o){confirm(`Are you sure you want to delete "${o.name}"?`)&&(this.store.dispatch(G({id:o.id})),this.router.navigate(["/"]))}openNote(o){this.eventBus.emitNoteSelected(o)}removeNoteFromNotebook(o){confirm("Remove this note from the notebook?")&&this.notebook$.pipe(I(e=>!!e),w(1)).subscribe(e=>{if(e){let t=e.notes.filter(n=>n.id!==o);this.store.dispatch(M({update:{id:e.id,changes:{notes:t}}}))}})}deleteNote(o){confirm("Are you sure you want to delete this note?")&&(this.removeNoteFromNotebook(o),this.store.dispatch(H({id:o})))}togglePin(o,e){e.stopPropagation(),this.store.dispatch(q({id:o.id})),this.notebook$.pipe(I(t=>!!t),w(1)).subscribe(t=>{if(t){let n=t.notes.map(i=>i.id===o.id?O(y({},i),{pinned:!i.pinned}):i);this.store.dispatch(M({update:{id:t.id,changes:{notes:n}}}))}})}handleNoteOption(o,e){switch(console.log("Note option selected:",o,e.title),o){case"removeFromNotebook":this.removeNoteFromNotebook(e.id);break;case"delete":this.deleteNote(e.id);break;case"addToNotebook":this.eventBus.triggerAddToNotebookModal(e);break;default:console.log("Unknown action:",o)}}navigateBack(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||r)(h(U),h(z),h(L),h(W))};static \u0275cmp=D({type:r,selectors:[["app-notebook-detail"]],decls:5,vars:6,consts:[[1,"notebook-detail-container"],["class","loading-state",4,"ngIf"],["class","notebook-detail",4,"ngIf"],[1,"loading-state"],[1,"bi","bi-arrow-clockwise"],[1,"notebook-detail"],[1,"notebook-header"],[1,"notebook-info"],[1,"notebook-info-items"],[1,"notebook-title"],[1,"section-title"],[1,"notebook-actions"],["customClass","notebook-action-button","icon","fluent:edit-28-regular","title","Edit Notebook",3,"clicked"],["customClass","notebook-action-button","icon","mage:trash","title","Delete Notebook",3,"clicked"],["title","Close Notebook",1,"notebook-close-button",3,"click"],[1,"bi","bi-x-lg"],["class","empty-state",4,"ngIf"],["class","content-sections",4,"ngIf"],[1,"empty-state"],[1,"empty-icon"],[1,"bi","bi-journal-x",2,"font-size","3rem","color","#ccc"],[1,"bi","bi-search",2,"font-size","3rem","color","#ccc"],[1,"content-sections"],["class","section",4,"ngIf"],[1,"section"],[1,"section-header"],[1,"notes-grid"],[3,"note","showNotebook","open","delete","togglePin","optionSelected",4,"ngFor","ngForOf","ngForTrackBy"],[3,"open","delete","togglePin","optionSelected","note","showNotebook"]],template:function(e,t){e&1&&(a(0,"div",0),N(1,te,3,0,"div",1),c(2,"async"),N(3,ce,23,18,"div",2),c(4,"async"),s()),e&2&&(p(),g("ngIf",!d(2,2,t.notebook$)&&!t.notFound),p(2),g("ngIf",d(4,4,t.notebook$)))},dependencies:[R,A,F,j,Y,X],styles:[".notebook-detail-container[_ngcontent-%COMP%]{padding:2rem 3rem;width:calc(100% - 400px);height:calc(100vh - 130px);margin-left:340px;margin-top:96px;margin-bottom:2rem;border:none;border-radius:20px;align-items:center;justify-content:center;box-sizing:border-box;background-color:#fff}.notebook-detail[_ngcontent-%COMP%]{box-sizing:border-box}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-info-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:0}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-actions[_ngcontent-%COMP%]{display:flex;gap:.8rem;align-items:center;justify-content:flex-start;opacity:1}.notebook-detail[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{align-items:center;color:var(--feature-button-color);font-size:small;font-weight:500;margin-top:.5rem;margin-bottom:1rem}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;height:calc(100vh - 240px);margin-top:1rem;border-radius:8px}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--header-search-bar-or-section-text-color);text-align:center}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]{margin-top:0}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-top:1.5rem}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;padding:.5rem 30px;gap:.4rem;cursor:pointer;font-size:1rem;background-color:#1b494d68;border:none;border-radius:50px;color:#fff;box-shadow:0 2px 8px #0000004d}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]:hover{background-color:#777c7cdc}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]   iconify-icon[_ngcontent-%COMP%]{font-size:1.2rem}.notebook-detail[_ngcontent-%COMP%]   .notes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;padding:0;margin:0}"]})};export{Z as NotebookDetail};
