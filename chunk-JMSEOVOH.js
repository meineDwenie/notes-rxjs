import{q as H,r as W,s as q}from"./chunk-DTV7VGZ7.js";import{n as Q}from"./chunk-5JRNSULR.js";import{i as z,j as B,k as R,m as D,o as L}from"./chunk-VGKXMW7M.js";import{Ab as I,Bb as O,Cb as S,Db as T,Eb as V,Hb as w,Ib as M,J as E,Jb as F,La as N,Oa as l,Ob as $,Sb as j,Ta as y,Tb as A,Vb as U,Za as P,cb as _,eb as u,pa as p,qa as m,qb as d,rb as r,sb as a,tb as b,ub as h,vb as C,w as x,wb as k,xb as g,yb as f}from"./chunk-AS2QI5Q4.js";var G=["fileInput"];function J(i,n){if(i&1&&(r(0,"div",21),b(1,"img",22),a()),i&2){let e=f().$implicit;l(),d("src",e,N)}}function K(i,n){if(i&1&&(r(0,"div",23),b(1,"img",22),r(2,"div",24),w(3),a()()),i&2){let e=f().$implicit,t=f(2).ngIf;l(),d("src",e,N),l(2),F("+",t.length-3)}}function X(i,n){if(i&1&&(h(0),_(1,J,2,1,"div",19)(2,K,4,2,"div",20),C()),i&2){let e=n.index,t=f(2).ngIf;l(),d("ngIf",e<2||t.length<=3),l(),d("ngIf",e===2&&t.length>3)}}function Z(i,n){if(i&1&&(r(0,"div",17),_(1,X,3,2,"ng-container",18),a()),i&2){let e=f().ngIf;l(),d("ngForOf",e.slice(0,3))}}function ee(i,n){if(i&1&&(h(0),_(1,Z,2,1,"div",16),C()),i&2){let e=n.ngIf;l(),d("ngIf",e.length)}}function te(i,n){if(i&1){let e=k();h(0),r(1,"app-button-feature",25),g("clicked",function(o){p(e);let s=f();return m(s.onRemoveFromNotebook(o))}),a(),C()}}function ne(i,n){if(i&1){let e=k();r(0,"app-button-feature",26),g("clicked",function(o){p(e);let s=f();return m(s.onDelete(o))}),a()}}var Y=class i{constructor(n,e){this.store=n;this.eventBus=e;this.notebooks$=this.store.select(H)}note;open=new u;delete=new u;togglePin=new u;addToNotebook=new u;removeFromNotebook=new u;imageUpload=new u;showCheckboxes=new u;addCheckboxes=new u;fileInput;notebooks$;isInNotebook$;containingNotebook$;ngOnInit(){this.isInNotebook$=this.notebooks$.pipe(x(n=>n.some(e=>e.notes.some(t=>t.id===this.note.id)))),this.containingNotebook$=this.notebooks$.pipe(x(n=>n.find(e=>e.notes.some(t=>t.id===this.note.id))))}onOpen(){this.open.emit(this.note)}onDelete(n){n.stopPropagation(),this.delete.emit(this.note.id)}onTogglePin(n){this.togglePin.emit({note:this.note,event:n})}openAddToNotebookModal(n){this.eventBus.triggerAddToNotebookModal(n)}onRemoveFromNotebook(n){n.stopPropagation(),this.containingNotebook$.pipe(E(1)).subscribe(e=>{e&&this.removeFromNotebook.emit({noteId:this.note.id,notebookId:e.id})})}triggerImageUpload(n){n.stopPropagation(),this.fileInput.nativeElement.click()}onImageSelected(n){let e=n.target;if(e.files){let t=[],o=0,s=e.files.length;Array.from(e.files).forEach(c=>{let v=new FileReader;v.onload=()=>{typeof v.result=="string"&&t.push(v.result),o++,o===s&&this.imageUpload.emit({noteId:this.note.id,images:t})},v.readAsDataURL(c)}),e.value=""}}addCheckboxesToContent(n){return n.split(`
`).map(o=>o.trim()?`\u2610 ${o}`:o).join(`
`)}toggleCheckbox(n,e){let t=n.split(`
`);return t[e]&&(t[e].startsWith("\u2610")?t[e]=t[e].replace("\u2610","\u2611"):t[e].startsWith("\u2611")&&(t[e]=t[e].replace("\u2611","\u2610"))),t.join(`
`)}static \u0275fac=function(e){return new(e||i)(y(Q),y(W))};static \u0275cmp=P({type:i,selectors:[["app-note"]],viewQuery:function(e,t){if(e&1&&I(G,5),e&2){let o;O(o=S())&&(t.fileInput=o.first)}},inputs:{note:"note"},outputs:{open:"open",delete:"delete",togglePin:"togglePin",addToNotebook:"addToNotebook",removeFromNotebook:"removeFromNotebook",imageUpload:"imageUpload",showCheckboxes:"showCheckboxes",addCheckboxes:"addCheckboxes"},decls:22,vars:12,consts:[["fileInput",""],["deleteButton",""],[3,"click"],[1,"note-title"],[4,"ngIf"],[1,"buttons-container",3,"click"],[1,"pin-icon"],[1,"bi",3,"click","ngClass","title"],["type","file","accept","image/*","multiple","",2,"display","none",3,"change"],[1,"left-buttons"],["customClass","image-button","icon","mage:image","title","Upload image",3,"clicked"],["customClass","add-to-notebook-button","icon","fluent:notebook-arrow-curve-down-20-regular","title","Add to notebook",3,"clicked"],["customClass","reminder-button","icon","carbon:reminder","title","Add reminder"],["customClass","add-checkboxes-button","icon","tabler:checkbox","title","Add checkboxes",3,"clicked"],["customClass","archive-button","icon","mage:archive","title","Archive note"],[4,"ngIf","ngIfElse"],["class","image-preview",4,"ngIf"],[1,"image-preview"],[4,"ngFor","ngForOf"],["class","image-wrapper",4,"ngIf"],["class","image-wrapper more-images-overlay",4,"ngIf"],[1,"image-wrapper"],[1,"preview-thumbnail",3,"src"],[1,"image-wrapper","more-images-overlay"],[1,"overlay"],["customClass","remove-from-notebook-button","icon","mdi:note-remove","title","Remove from notebook",3,"clicked"],["customClass","delete-note-button","icon","mage:trash","title","Delete note",3,"clicked"]],template:function(e,t){if(e&1){let o=k();r(0,"li",2),g("click",function(){return p(o),m(t.onOpen())}),r(1,"div")(2,"h3",3),w(3),a(),r(4,"p"),w(5),a(),_(6,ee,2,1,"ng-container",4),a(),r(7,"div",5),g("click",function(c){return p(o),m(c.stopPropagation())}),r(8,"div",6)(9,"i",7),g("click",function(c){return p(o),m(t.onTogglePin(c))}),a()(),r(10,"input",8,0),g("change",function(c){return p(o),m(t.onImageSelected(c))}),a(),r(12,"div",9)(13,"app-button-feature",10),g("clicked",function(c){return p(o),m(t.triggerImageUpload(c))}),a(),r(14,"app-button-feature",11),g("clicked",function(){return p(o),m(t.openAddToNotebookModal(t.note))}),a(),b(15,"app-button-feature",12),r(16,"app-button-feature",13),g("clicked",function(c){return p(o),m(t.onDelete(c))}),a(),b(17,"app-button-feature",14),_(18,te,2,0,"ng-container",15),j(19,"async"),_(20,ne,1,0,"ng-template",null,1,U),a()()()}if(e&2){let o=T(21);V("background-color",t.note.color||"#ffffff"),l(3),M(t.note.title),l(2),M(t.note.content),l(),d("ngIf",t.note.images),l(3),d("title",$(t.note.pinned?"Unpin":"Pin"))("ngClass",t.note.pinned?"bi-pin-fill":"bi-pin"),l(9),d("ngIf",A(19,10,t.isInNotebook$))("ngIfElse",o)}},dependencies:[L,z,B,R,D,q],styles:["li[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-radius:6px;min-height:280px;height:auto;padding:1rem;display:flex;flex-direction:column;justify-content:space-between;align-items:flex-start;cursor:default;overflow:visible;transition:all .2s ease;outline:.5px solid rgba(150,150,150,.3)}li[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #43868626;transform:translateY(-2px)}.note-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;line-height:1.3;width:86%}p[_ngcontent-%COMP%]{margin:0;font-size:15px;line-height:18pt;color:#343434;display:-webkit-box;-webkit-line-clamp:7;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;max-height:220px;white-space:pre-wrap}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{margin-top:0;cursor:default}.image-preview[_ngcontent-%COMP%]{display:flex;gap:6px;margin-top:.5rem}.image-preview[_ngcontent-%COMP%]   .image-wrapper[_ngcontent-%COMP%]   .preview-thumbnail[_ngcontent-%COMP%]{height:60px;width:auto;object-fit:cover;border-radius:4px}.buttons-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-top:1rem;opacity:0;pointer-events:auto;transition:opacity .2s ease-in-out;width:100%}li[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.left-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem}.pin-icon[_ngcontent-%COMP%]{position:absolute;top:14px;right:14px;padding:4px 6px 2px;cursor:pointer;font-size:1.2rem;color:var(--feature-button-color);z-index:10}.pin-icon[_ngcontent-%COMP%]:hover{color:var(--feature-button-hover-color);background-color:var(--feature-button-hover-background-color);border-radius:8px}.image-preview[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:flex-start;margin:1rem 0 0;gap:.5rem;width:auto;height:70%}.image-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;width:60px;height:60px;border-radius:4px;overflow:hidden}.preview-thumbnail[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:4px;border:1px solid #ccc;transition:transform .2s ease}.more-images-overlay[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#28282899;color:#fff;font-size:16px;font-weight:700;display:flex;justify-content:center;align-items:center;border-radius:4px}.loading-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;background-color:#f0f0f0;color:#666;font-size:12px;border-radius:8px}.remove-image-btn[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:20px;height:20px;border-radius:50%;background-color:#f44;color:#fff;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;z-index:10}.remove-image-btn[_ngcontent-%COMP%]:hover{background-color:#c33}input[type=file][_ngcontent-%COMP%]{display:none}"]})};export{Y as a};
