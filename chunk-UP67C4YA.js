import{a as te}from"./chunk-GUES7C6T.js";import{e as H,g as Y,m as T,n as Q,q as D,r as Z,s as ee}from"./chunk-EKU5Z4EG.js";import{B as W,D as X,n as q,u as G,w as J,x as K}from"./chunk-KBODP7Z6.js";import{m as U,o as L}from"./chunk-5IK5MZEV.js";import{$ as A,Ab as v,Bb as g,Cb as l,E as V,J as w,Kb as _,Lb as $,Mb as R,Nb as z,Oa as p,Ta as h,Wb as c,Xb as d,Za as j,_ as F,a as O,b as P,k as B,ob as M,pa as m,pb as u,qa as b,rb as f,ub as I,vb as S,w as k,wb as E,x as y,xb as s,yb as a,zb as x}from"./chunk-5VIB32CO.js";function ie(r,n){r&1&&(s(0,"div",1),x(1,"i",3),_(2," Loading notebook... "),a())}function re(r,n){r&1&&(s(0,"div",14)(1,"div",16),x(2,"i",17),a(),s(3,"h2"),_(4,"This notebook is empty"),a(),s(5,"p"),_(6,"Add some notes to this notebook to get started!"),a()())}function ae(r,n){if(r&1&&(s(0,"div",14)(1,"div",16),x(2,"i",18),a(),s(3,"h2"),_(4,"No notes found"),a(),s(5,"p"),_(6,' No notes in this notebook match your search for "'),s(7,"strong"),_(8),c(9,"async"),a(),_(10,'" '),a()()),r&2){let e=l(2);p(8),$(d(9,1,e.searchTerm$))}}function se(r,n){if(r&1){let e=v();s(0,"app-note",24),g("open",function(o){m(e);let i=l(4);return b(i.openNote(o))})("delete",function(o){m(e);let i=l(4);return b(i.deleteNote(o))})("removeFromNotebook",function(o){m(e);let i=l(4);return b(i.removeNoteFromNotebook(o))})("togglePin",function(o){m(e);let i=l(4);return b(i.togglePin(o.note,o.event))}),a()}if(r&2){let e=n.$implicit;E("note",e)("showNotebook",!1)}}function le(r,n){if(r&1&&(s(0,"div",19)(1,"div",20)(2,"h2",21),_(3,"PINNED"),a()(),s(4,"div",22),I(5,se,1,2,"app-note",23,M().trackByNoteId,!0),c(7,"async"),a()()),r&2){let e=l(3);p(5),S(d(7,0,e.pinnedNotesInNotebook$))}}function ce(r,n){if(r&1){let e=v();s(0,"app-note",24),g("open",function(o){m(e);let i=l(4);return b(i.openNote(o))})("delete",function(o){m(e);let i=l(4);return b(i.deleteNote(o))})("removeFromNotebook",function(o){m(e);let i=l(4);return b(i.removeNoteFromNotebook(o))})("togglePin",function(o){m(e);let i=l(4);return b(i.togglePin(o.note,o.event))}),a()}if(r&2){let e=n.$implicit;E("note",e)("showNotebook",!1)}}function de(r,n){if(r&1&&(s(0,"div",19)(1,"div",20)(2,"h2",21),_(3),c(4,"async"),a()(),s(5,"div",22),I(6,ce,1,2,"app-note",23,M().trackByNoteId,!0),c(8,"async"),a()()),r&2){let e=l(3);p(3),R(" ",d(4,1,e.hasPinnedNotesInNotebook$)?"OTHER NOTES":"YOUR NOTES"," "),p(3),S(d(8,3,e.unpinnedNotesInNotebook$))}}function pe(r,n){if(r&1&&(s(0,"div",15),u(1,le,8,2,"div",19),c(2,"async"),u(3,de,9,5,"div",19),c(4,"async"),a()),r&2){let e=l(2);p(),f(d(2,2,e.hasPinnedNotesInNotebook$)?1:-1),p(2),f(d(4,4,e.hasUnpinnedNotesInNotebook$)?3:-1)}}function _e(r,n){if(r&1){let e=v();s(0,"div",2)(1,"div",4)(2,"div",5)(3,"div",6)(4,"h1",7),_(5),a(),s(6,"h2",8),_(7),a()(),s(8,"div",9)(9,"app-button-feature",10),g("clicked",function(){let o=m(e),i=l();return b(i.editNotebook(o))}),a(),s(10,"app-button-feature",11),g("clicked",function(){let o=m(e),i=l();return b(i.deleteNotebook(o))}),a(),s(11,"button",12),g("click",function(){m(e);let o=l();return b(o.navigateBack())}),x(12,"i",13),_(13," Close "),a()()()(),u(14,re,7,0,"div",14),u(15,ae,11,3,"div",14),c(16,"async"),c(17,"async"),c(18,"async"),c(19,"async"),u(20,pe,5,6,"div",15),c(21,"async"),c(22,"async"),a()}if(r&2){let e=n,t=l();p(5),$(e.name),p(2),z(" ",e.notes.length," ",e.notes.length<=1?"NOTE":"NOTES"," "),p(7),f(e.notes.length===0?14:-1),p(),f(e.notes.length>0&&d(16,6,t.searchTerm$)&&d(17,8,t.searchTerm$).trim().length>0&&!d(18,10,t.hasPinnedNotesInNotebook$)&&!d(19,12,t.hasUnpinnedNotesInNotebook$)?15:-1),p(5),f(d(21,14,t.hasPinnedNotesInNotebook$)||d(22,16,t.hasUnpinnedNotesInNotebook$)?20:-1)}}var oe=class r{constructor(n,e,t,o){this.route=n;this.router=e;this.store=t;this.eventBus=o}notebook$;allNotes$;searchTerm$;pinnedNotesInNotebook$;unpinnedNotesInNotebook$;hasPinnedNotesInNotebook$;hasUnpinnedNotesInNotebook$;notFound=!1;openNotebookOptionsId=null;destroy$=new B;ngOnInit(){this.allNotes$=this.store.select(W),this.searchTerm$=this.store.select(X),this.notebook$=y([this.route.params,this.store.select(D),this.allNotes$]).pipe(k(([e,t,o])=>{let i=t.find(N=>N.id===e.id);if(!i&&t.length>0){this.notFound=!0;return}if(!i)return;let C=i.notes.map(N=>o.find(ne=>ne.id===N.id)||N).filter(N=>!!N);return P(O({},i),{notes:C})}),A(e=>{e&&console.log("Final notebook with notes:",e.notes.length)}),F(this.destroy$));let n=y([this.notebook$,this.searchTerm$]).pipe(k(([e,t])=>e?t.trim()?e.notes.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())||o.content.toLowerCase().includes(t.toLowerCase())):e.notes:[]));this.pinnedNotesInNotebook$=n.pipe(k(e=>e.filter(t=>t.pinned))),this.unpinnedNotesInNotebook$=n.pipe(k(e=>e.filter(t=>!t.pinned))),this.hasPinnedNotesInNotebook$=this.pinnedNotesInNotebook$.pipe(k(e=>e.length>0)),this.hasUnpinnedNotesInNotebook$=this.unpinnedNotesInNotebook$.pipe(k(e=>e.length>0))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}trackByNoteId(n,e){return e.id}openNote(n){this.eventBus.emitNoteSelected(n)}editNotebook(n){this.startEditingNotebook(n)}startEditingNotebook(n){this.openNotebookOptionsId=null,this.eventBus.emitNotebookEdit(n)}deleteNotebook(n){confirm(`Are you sure you want to delete "${n.name}"?`)&&(this.store.dispatch(Q({id:n.id})),this.router.navigate(["/"]))}removeNoteFromNotebook(n){let{noteId:e,notebookId:t}=n;confirm("Remove this note from the notebook?")&&this.store.select(D).pipe(k(o=>o.find(i=>i.id===t)),w(1)).subscribe(o=>{if(o){let i=o.notes.find(C=>C.id===e);if(i){this.store.dispatch(G({note:i}));let C=o.notes.filter(N=>N.id!==e);this.store.dispatch(T({update:{id:o.id,changes:{notes:C}}}))}}})}deleteNote(n){confirm("Are you sure you want to delete this note?")&&this.store.dispatch(J({id:n}))}togglePin(n,e){e.stopPropagation(),this.store.dispatch(K({id:n.id})),this.notebook$.pipe(V(t=>!!t),w(1)).subscribe(t=>{if(t){let o=t.notes.map(i=>i.id===n.id?P(O({},i),{pinned:!i.pinned}):i);this.store.dispatch(T({update:{id:t.id,changes:{notes:o}}}))}})}navigateBack(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||r)(h(H),h(Y),h(q),h(Z))};static \u0275cmp=j({type:r,selectors:[["app-notebook-detail"]],decls:5,vars:6,consts:[[1,"notebook-detail-container"],[1,"loading-state"],[1,"notebook-detail"],[1,"bi","bi-arrow-clockwise"],[1,"notebook-header"],[1,"notebook-info"],[1,"notebook-info-items"],[1,"notebook-title"],[1,"note-count"],[1,"notebook-actions"],["customClass","notebook-action-button","icon","fluent:edit-28-regular","title","Edit Notebook Title",3,"clicked"],["customClass","notebook-action-button","icon","mage:trash","title","Delete Notebook",3,"clicked"],["title","Close Notebook","icon","fluent:notebook-section-arrow-right-20-regular",1,"notebook-close-button",3,"click"],[1,"bi","bi-x-lg"],[1,"empty-state"],[1,"content-sections"],[1,"empty-icon"],[1,"bi","bi-journal-x",2,"font-size","3rem","color","#ccc"],[1,"bi","bi-search",2,"font-size","3rem","color","#ccc"],[1,"section"],[1,"section-header"],[1,"section-title"],[1,"notes-grid"],[3,"note","showNotebook"],[3,"open","delete","removeFromNotebook","togglePin","note","showNotebook"]],template:function(e,t){if(e&1&&(s(0,"div",0),u(1,ie,3,0,"div",1),c(2,"async"),u(3,_e,23,18,"div",2),c(4,"async"),a()),e&2){let o;p(),f(!d(2,2,t.notebook$)&&!t.notFound?1:-1),p(2),f((o=d(4,4,t.notebook$))?3:-1,o)}},dependencies:[L,U,te,ee],styles:[".notebook-detail-container[_ngcontent-%COMP%]{padding:2rem 3rem;width:calc(100% - 400px);height:auto;min-height:calc(100vh - 130px);margin-left:340px;margin-top:96px;margin-bottom:2rem;border:none;border-radius:20px;align-items:center;justify-content:center;box-sizing:border-box;background-color:#fff}.notebook-detail[_ngcontent-%COMP%]{box-sizing:border-box}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-info-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:0}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-actions[_ngcontent-%COMP%]{display:flex;gap:.8rem;align-items:center;justify-content:flex-start;opacity:1}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .note-count[_ngcontent-%COMP%]{color:var(--feature-button-color);font-size:small;font-weight:500;margin-top:.5rem;margin-bottom:1rem}.notebook-detail[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;color:#000;font-size:1rem;font-weight:700;margin-top:1rem;margin-bottom:1rem}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;height:calc(100vh - 300px);margin-top:1rem;border-radius:8px}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--header-search-bar-or-section-text-color);text-align:center}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]{margin-top:0}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-top:1.5rem}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;padding:.5rem 26px .5rem 24px;gap:.4rem;cursor:pointer;font-size:1rem;background-color:#1b494d68;border:none;border-radius:50px;color:#fff;box-shadow:0 2px 8px #0000004d}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]:hover{background-color:#777c7cdc}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]   iconify-icon[_ngcontent-%COMP%]{font-size:1.2rem}.notebook-detail[_ngcontent-%COMP%]   .notes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;padding:0;margin:0}"]})};export{oe as NotebookDetail};
