import{a as W}from"./chunk-TXEKPRYA.js";import{F as U,K as L,L as H,O as I,P as q,S as G,V as J,Y as K,Z as Q,c as B,d as A,f as F,h as j,m as R,o as z}from"./chunk-CQFGOGRQ.js";import{$ as E,Cb as b,Db as $,E as y,Eb as D,Fb as V,J as P,Nb as k,Oa as p,Ob as f,Ta as v,Za as T,_ as S,a as C,b as O,cb as g,k as w,ob as _,pa as c,pb as a,qa as d,qb as s,rb as h,sb as x,tb as u,ub as l,w as N,x as M}from"./chunk-SEEG46KC.js";function Z(r,t){r&1&&(a(0,"div",3),h(1,"i",4),b(2," Loading notebook... "),s())}function ee(r,t){r&1&&(a(0,"div",18)(1,"div",19),h(2,"i",20),s(),a(3,"h2"),b(4,"This notebook is empty"),s(),a(5,"p"),b(6,"Add some notes to this notebook to get started!"),s()())}function te(r,t){if(r&1){let e=x();a(0,"app-note",27),u("open",function(o){c(e);let n=l(4);return d(n.openNote(o))})("delete",function(o){c(e);let n=l(4);return d(n.deleteNote(o))})("togglePin",function(o){c(e);let n=l(4);return d(n.togglePin(o.note,o.event))})("optionSelected",function(o){let n=c(e).$implicit,m=l(4);return d(m.handleNoteOption(o,n))}),s()}if(r&2){let e=t.$implicit;_("note",e)("showNotebook",!1)}}function oe(r,t){if(r&1&&(a(0,"div",23)(1,"div",24)(2,"h2",10),b(3,"PINNED"),s()(),a(4,"div",25),g(5,te,1,2,"app-note",26),k(6,"async"),s()()),r&2){let e=l(3);p(5),_("ngForOf",f(6,2,e.pinnedNotesInNotebook$))("ngForTrackBy",e.trackByNoteId)}}function ne(r,t){if(r&1){let e=x();a(0,"app-note",27),u("open",function(o){c(e);let n=l(4);return d(n.openNote(o))})("delete",function(o){c(e);let n=l(4);return d(n.deleteNote(o))})("togglePin",function(o){c(e);let n=l(4);return d(n.togglePin(o.note,o.event))})("optionSelected",function(o){let n=c(e).$implicit,m=l(4);return d(m.handleNoteOption(o,n))}),s()}if(r&2){let e=t.$implicit;_("note",e)("showNotebook",!1)}}function ie(r,t){if(r&1&&(a(0,"div",23)(1,"div",24)(2,"h2",10),b(3),k(4,"async"),s()(),a(5,"div",25),g(6,ne,1,2,"app-note",26),k(7,"async"),s()()),r&2){let e=l(3);p(3),D(" ",f(4,3,e.hasPinnedNotesInNotebook$)?"OTHER NOTES":"NOTES"," "),p(3),_("ngForOf",f(7,5,e.unpinnedNotesInNotebook$))("ngForTrackBy",e.trackByNoteId)}}function re(r,t){if(r&1&&(a(0,"div",21),g(1,oe,7,4,"div",22),k(2,"async"),g(3,ie,8,7,"div",22),k(4,"async"),s()),r&2){let e=l(2);p(),_("ngIf",f(2,2,e.hasPinnedNotesInNotebook$)),p(2),_("ngIf",f(4,4,e.hasUnpinnedNotesInNotebook$))}}function se(r,t){if(r&1){let e=x();a(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"h1",9),b(5),s(),a(6,"h2",10),b(7),s()(),a(8,"div",11)(9,"app-button-feature",12),u("clicked",function(){let o=c(e).ngIf,n=l();return d(n.editNotebook(o))}),s(),a(10,"app-button-feature",13),u("clicked",function(){let o=c(e).ngIf,n=l();return d(n.deleteNotebook(o))}),s(),a(11,"button",14),u("click",function(){c(e);let o=l();return d(o.navigateBack())}),h(12,"i",15),b(13," Close "),s()()()(),g(14,ee,7,0,"div",16)(15,re,5,6,"div",17),s()}if(r&2){let e=t.ngIf;p(5),$(e.name),p(2),V(" ",e.notes.length," ",e.notes.length<=1?"NOTE":"NOTES"," "),p(7),_("ngIf",e.notes.length===0),p(),_("ngIf",e.notes.length>0)}}var X=class r{constructor(t,e,i,o){this.route=t;this.router=e;this.store=i;this.eventBus=o}notebook$;allNotes$;pinnedNotesInNotebook$;unpinnedNotesInNotebook$;hasPinnedNotesInNotebook$;hasUnpinnedNotesInNotebook$;notFound=!1;openNotebookOptionsId=null;destroy$=new w;ngOnInit(){this.allNotes$=this.store.select(J),this.notebook$=M([this.route.params,this.store.select(G),this.allNotes$]).pipe(N(([t,e,i])=>{let o=e.find(m=>m.id===t.id);if(!o&&e.length>0){this.notFound=!0;return}if(!o)return;let n=o.notes.map(m=>i.find(Y=>Y.id===m.id)||m).filter(m=>!!m);return O(C({},o),{notes:n})}),E(t=>{t&&console.log("Final notebook with notes:",t.notes.length)}),S(this.destroy$)),this.pinnedNotesInNotebook$=this.notebook$.pipe(N(t=>t?t.notes.filter(e=>e.pinned):[])),this.unpinnedNotesInNotebook$=this.notebook$.pipe(N(t=>t?t.notes.filter(e=>!e.pinned):[])),this.hasPinnedNotesInNotebook$=this.pinnedNotesInNotebook$.pipe(N(t=>t.length>0)),this.hasUnpinnedNotesInNotebook$=this.unpinnedNotesInNotebook$.pipe(N(t=>t.length>0))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}trackByNoteId(t,e){return e.id}editNotebook(t){this.startEditingNotebook(t)}startEditingNotebook(t){this.openNotebookOptionsId=null,this.eventBus.emitNotebookEdit(t)}deleteNotebook(t){confirm(`Are you sure you want to delete "${t.name}"?`)&&(this.store.dispatch(q({id:t.id})),this.router.navigate(["/"]))}openNote(t){this.eventBus.emitNoteSelected(t)}removeNoteFromNotebook(t){confirm("Remove this note from the notebook?")&&this.notebook$.pipe(y(e=>!!e),P(1)).subscribe(e=>{if(e){let i=e.notes.filter(o=>o.id!==t);this.store.dispatch(I({update:{id:e.id,changes:{notes:i}}}))}})}deleteNote(t){confirm("Are you sure you want to delete this note?")&&(this.removeNoteFromNotebook(t),this.store.dispatch(L({id:t})))}togglePin(t,e){e.stopPropagation(),this.store.dispatch(H({id:t.id})),this.notebook$.pipe(y(i=>!!i),P(1)).subscribe(i=>{if(i){let o=i.notes.map(n=>n.id===t.id?O(C({},n),{pinned:!n.pinned}):n);this.store.dispatch(I({update:{id:i.id,changes:{notes:o}}}))}})}handleNoteOption(t,e){switch(console.log("Note option selected:",t,e.title),t){case"removeFromNotebook":this.removeNoteFromNotebook(e.id);break;case"delete":this.deleteNote(e.id);break;case"addToNotebook":this.eventBus.triggerAddToNotebookModal(e);break;default:console.log("Unknown action:",t)}}navigateBack(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||r)(v(R),v(z),v(U),v(K))};static \u0275cmp=T({type:r,selectors:[["app-notebook-detail"]],decls:5,vars:6,consts:[[1,"notebook-detail-container"],["class","loading-state",4,"ngIf"],["class","notebook-detail",4,"ngIf"],[1,"loading-state"],[1,"bi","bi-arrow-clockwise"],[1,"notebook-detail"],[1,"notebook-header"],[1,"notebook-info"],[1,"notebook-info-items"],[1,"notebook-title"],[1,"section-title"],[1,"notebook-actions"],["customClass","notebook-action-button","icon","fluent:edit-28-regular","title","Edit Notebook",3,"clicked"],["customClass","notebook-action-button","icon","mage:trash","title","Delete Notebook",3,"clicked"],["title","Close Notebook",1,"notebook-close-button",3,"click"],[1,"bi","bi-x-lg"],["class","empty-state",4,"ngIf"],["class","content-sections",4,"ngIf"],[1,"empty-state"],[1,"empty-icon"],[1,"bi","bi-journal-x",2,"font-size","3rem","color","#ccc"],[1,"content-sections"],["class","section",4,"ngIf"],[1,"section"],[1,"section-header"],[1,"notes-grid"],[3,"note","showNotebook","open","delete","togglePin","optionSelected",4,"ngFor","ngForOf","ngForTrackBy"],[3,"open","delete","togglePin","optionSelected","note","showNotebook"]],template:function(e,i){e&1&&(a(0,"div",0),g(1,Z,3,0,"div",1),k(2,"async"),g(3,se,16,5,"div",2),k(4,"async"),s()),e&2&&(p(),_("ngIf",!f(2,2,i.notebook$)&&!i.notFound),p(2),_("ngIf",f(4,4,i.notebook$)))},dependencies:[j,B,A,F,W,Q],styles:[".notebook-detail-container[_ngcontent-%COMP%]{padding:2rem 3rem;width:calc(100% - 400px);height:calc(100vh - 130px);margin-left:340px;margin-top:96px;margin-bottom:2rem;border:none;border-radius:20px;align-items:center;justify-content:center;box-sizing:border-box;background-color:#fff}.notebook-detail[_ngcontent-%COMP%]{box-sizing:border-box}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-info-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:0}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-actions[_ngcontent-%COMP%]{display:flex;gap:.8rem;align-items:center;justify-content:flex-start;opacity:1}.notebook-detail[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{align-items:center;color:var(--feature-button-color);font-size:small;font-weight:500;margin-top:.5rem;margin-bottom:1rem}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;height:calc(100vh - 240px);margin-top:1rem;border-radius:8px}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--header-search-bar-or-section-text-color);text-align:center}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]{margin-top:0}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-top:1.5rem}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;padding:.5rem 30px;gap:.4rem;cursor:pointer;font-size:1rem;background-color:#1b494d68;border:none;border-radius:50px;color:#fff;box-shadow:0 2px 8px #0000004d}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]:hover{background-color:#777c7cdc}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]   iconify-icon[_ngcontent-%COMP%]{font-size:1.2rem}.notebook-detail[_ngcontent-%COMP%]   .notes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;padding:0;margin:0}"]})};export{X as NotebookDetail};
