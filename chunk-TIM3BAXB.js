import{a as Z}from"./chunk-MS7KJOF6.js";import{e as U,g as L,m as M,n as J,q as S,r as W,s as X}from"./chunk-DTV7VGZ7.js";import{B as K,D as Q,n as H,u as Y,w as q,x as G}from"./chunk-5JRNSULR.js";import{j as A,k as j,m as R,o as z}from"./chunk-VGKXMW7M.js";import{$ as D,E as $,Hb as _,Ib as w,J as I,Jb as V,Kb as F,Oa as p,Sb as l,Ta as h,Tb as d,Za as B,_ as T,a as y,b as O,cb as f,k as E,pa as m,qa as b,qb as g,rb as a,sb as s,tb as x,w as k,wb as C,x as P,xb as u,yb as c}from"./chunk-AS2QI5Q4.js";function oe(r,n){r&1&&(a(0,"div",3),x(1,"i",4),_(2," Loading notebook... "),s())}function ne(r,n){r&1&&(a(0,"div",18)(1,"div",19),x(2,"i",20),s(),a(3,"h2"),_(4,"This notebook is empty"),s(),a(5,"p"),_(6,"Add some notes to this notebook to get started!"),s()())}function ie(r,n){if(r&1&&(a(0,"div",18)(1,"div",19),x(2,"i",21),s(),a(3,"h2"),_(4,"No notes found"),s(),a(5,"p"),_(6,' No notes in this notebook match your search for "'),a(7,"strong"),_(8),l(9,"async"),s(),_(10,'" '),s()()),r&2){let e=c(2);p(8),w(d(9,1,e.searchTerm$))}}function re(r,n){if(r&1){let e=C();a(0,"app-note",29),u("open",function(o){m(e);let i=c(4);return b(i.openNote(o))})("delete",function(o){m(e);let i=c(4);return b(i.deleteNote(o))})("removeFromNotebook",function(o){m(e);let i=c(4);return b(i.removeNoteFromNotebook(o))})("togglePin",function(o){m(e);let i=c(4);return b(i.togglePin(o.note,o.event))}),s()}if(r&2){let e=n.$implicit;g("note",e)("showNotebook",!1)}}function se(r,n){if(r&1&&(a(0,"div",24)(1,"div",25)(2,"h2",26),_(3,"PINNED"),s()(),a(4,"div",27),f(5,re,1,2,"app-note",28),l(6,"async"),s()()),r&2){let e=c(3);p(5),g("ngForOf",d(6,2,e.pinnedNotesInNotebook$))("ngForTrackBy",e.trackByNoteId)}}function ae(r,n){if(r&1){let e=C();a(0,"app-note",29),u("open",function(o){m(e);let i=c(4);return b(i.openNote(o))})("delete",function(o){m(e);let i=c(4);return b(i.deleteNote(o))})("removeFromNotebook",function(o){m(e);let i=c(4);return b(i.removeNoteFromNotebook(o))})("togglePin",function(o){m(e);let i=c(4);return b(i.togglePin(o.note,o.event))}),s()}if(r&2){let e=n.$implicit;g("note",e)("showNotebook",!1)}}function ce(r,n){if(r&1&&(a(0,"div",24)(1,"div",25)(2,"h2",26),_(3),l(4,"async"),s()(),a(5,"div",27),f(6,ae,1,2,"app-note",28),l(7,"async"),s()()),r&2){let e=c(3);p(3),V(" ",d(4,3,e.hasPinnedNotesInNotebook$)?"OTHER NOTES":"YOUR NOTES"," "),p(3),g("ngForOf",d(7,5,e.unpinnedNotesInNotebook$))("ngForTrackBy",e.trackByNoteId)}}function le(r,n){if(r&1&&(a(0,"div",22),f(1,se,7,4,"div",23),l(2,"async"),f(3,ce,8,7,"div",23),l(4,"async"),s()),r&2){let e=c(2);p(),g("ngIf",d(2,2,e.hasPinnedNotesInNotebook$)),p(2),g("ngIf",d(4,4,e.hasUnpinnedNotesInNotebook$))}}function de(r,n){if(r&1){let e=C();a(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"h1",9),_(5),s(),a(6,"h2",10),_(7),s()(),a(8,"div",11)(9,"app-button-feature",12),u("clicked",function(){let o=m(e).ngIf,i=c();return b(i.editNotebook(o))}),s(),a(10,"app-button-feature",13),u("clicked",function(){let o=m(e).ngIf,i=c();return b(i.deleteNotebook(o))}),s(),a(11,"button",14),u("click",function(){m(e);let o=c();return b(o.navigateBack())}),x(12,"i",15),_(13," Close "),s()()()(),f(14,ne,7,0,"div",16)(15,ie,11,3,"div",16),l(16,"async"),l(17,"async"),l(18,"async"),l(19,"async"),f(20,le,5,6,"div",17),l(21,"async"),l(22,"async"),s()}if(r&2){let e=n.ngIf,t=c();p(5),w(e.name),p(2),F(" ",e.notes.length," ",e.notes.length<=1?"NOTE":"NOTES"," "),p(7),g("ngIf",e.notes.length===0),p(),g("ngIf",e.notes.length>0&&d(16,6,t.searchTerm$)&&d(17,8,t.searchTerm$).trim().length>0&&!d(18,10,t.hasPinnedNotesInNotebook$)&&!d(19,12,t.hasUnpinnedNotesInNotebook$)),p(5),g("ngIf",d(21,14,t.hasPinnedNotesInNotebook$)||d(22,16,t.hasUnpinnedNotesInNotebook$))}}var ee=class r{constructor(n,e,t,o){this.route=n;this.router=e;this.store=t;this.eventBus=o}notebook$;allNotes$;searchTerm$;pinnedNotesInNotebook$;unpinnedNotesInNotebook$;hasPinnedNotesInNotebook$;hasUnpinnedNotesInNotebook$;notFound=!1;openNotebookOptionsId=null;destroy$=new E;ngOnInit(){this.allNotes$=this.store.select(K),this.searchTerm$=this.store.select(Q),this.notebook$=P([this.route.params,this.store.select(S),this.allNotes$]).pipe(k(([e,t,o])=>{let i=t.find(N=>N.id===e.id);if(!i&&t.length>0){this.notFound=!0;return}if(!i)return;let v=i.notes.map(N=>o.find(te=>te.id===N.id)||N).filter(N=>!!N);return O(y({},i),{notes:v})}),D(e=>{e&&console.log("Final notebook with notes:",e.notes.length)}),T(this.destroy$));let n=P([this.notebook$,this.searchTerm$]).pipe(k(([e,t])=>e?t.trim()?e.notes.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())||o.content.toLowerCase().includes(t.toLowerCase())):e.notes:[]));this.pinnedNotesInNotebook$=n.pipe(k(e=>e.filter(t=>t.pinned))),this.unpinnedNotesInNotebook$=n.pipe(k(e=>e.filter(t=>!t.pinned))),this.hasPinnedNotesInNotebook$=this.pinnedNotesInNotebook$.pipe(k(e=>e.length>0)),this.hasUnpinnedNotesInNotebook$=this.unpinnedNotesInNotebook$.pipe(k(e=>e.length>0))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}trackByNoteId(n,e){return e.id}openNote(n){this.eventBus.emitNoteSelected(n)}editNotebook(n){this.startEditingNotebook(n)}startEditingNotebook(n){this.openNotebookOptionsId=null,this.eventBus.emitNotebookEdit(n)}deleteNotebook(n){confirm(`Are you sure you want to delete "${n.name}"?`)&&(this.store.dispatch(J({id:n.id})),this.router.navigate(["/"]))}removeNoteFromNotebook(n){let{noteId:e,notebookId:t}=n;confirm("Remove this note from the notebook?")&&this.store.select(S).pipe(k(o=>o.find(i=>i.id===t)),I(1)).subscribe(o=>{if(o){let i=o.notes.find(v=>v.id===e);if(i){this.store.dispatch(Y({note:i}));let v=o.notes.filter(N=>N.id!==e);this.store.dispatch(M({update:{id:o.id,changes:{notes:v}}}))}}})}deleteNote(n){confirm("Are you sure you want to delete this note?")&&this.store.dispatch(q({id:n}))}togglePin(n,e){e.stopPropagation(),this.store.dispatch(G({id:n.id})),this.notebook$.pipe($(t=>!!t),I(1)).subscribe(t=>{if(t){let o=t.notes.map(i=>i.id===n.id?O(y({},i),{pinned:!i.pinned}):i);this.store.dispatch(M({update:{id:t.id,changes:{notes:o}}}))}})}navigateBack(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||r)(h(U),h(L),h(H),h(W))};static \u0275cmp=B({type:r,selectors:[["app-notebook-detail"]],decls:5,vars:6,consts:[[1,"notebook-detail-container"],["class","loading-state",4,"ngIf"],["class","notebook-detail",4,"ngIf"],[1,"loading-state"],[1,"bi","bi-arrow-clockwise"],[1,"notebook-detail"],[1,"notebook-header"],[1,"notebook-info"],[1,"notebook-info-items"],[1,"notebook-title"],[1,"note-count"],[1,"notebook-actions"],["customClass","notebook-action-button","icon","fluent:edit-28-regular","title","Edit Notebook",3,"clicked"],["customClass","notebook-action-button","icon","mage:trash","title","Delete Notebook",3,"clicked"],["title","Close Notebook","icon","fluent:notebook-section-arrow-right-20-regular",1,"notebook-close-button",3,"click"],[1,"bi","bi-x-lg"],["class","empty-state",4,"ngIf"],["class","content-sections",4,"ngIf"],[1,"empty-state"],[1,"empty-icon"],[1,"bi","bi-journal-x",2,"font-size","3rem","color","#ccc"],[1,"bi","bi-search",2,"font-size","3rem","color","#ccc"],[1,"content-sections"],["class","section",4,"ngIf"],[1,"section"],[1,"section-header"],[1,"section-title"],[1,"notes-grid"],[3,"note","showNotebook","open","delete","removeFromNotebook","togglePin",4,"ngFor","ngForOf","ngForTrackBy"],[3,"open","delete","removeFromNotebook","togglePin","note","showNotebook"]],template:function(e,t){e&1&&(a(0,"div",0),f(1,oe,3,0,"div",1),l(2,"async"),f(3,de,23,18,"div",2),l(4,"async"),s()),e&2&&(p(),g("ngIf",!d(2,2,t.notebook$)&&!t.notFound),p(2),g("ngIf",d(4,4,t.notebook$)))},dependencies:[z,A,j,R,Z,X],styles:[".notebook-detail-container[_ngcontent-%COMP%]{padding:2rem 3rem;width:calc(100% - 400px);height:auto;margin-left:340px;margin-top:96px;margin-bottom:2rem;border:none;border-radius:20px;align-items:center;justify-content:center;box-sizing:border-box;background-color:#fff}.notebook-detail[_ngcontent-%COMP%]{box-sizing:border-box}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-info-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:0}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-actions[_ngcontent-%COMP%]{display:flex;gap:.8rem;align-items:center;justify-content:flex-start;opacity:1}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .note-count[_ngcontent-%COMP%]{color:var(--feature-button-color);font-size:small;font-weight:500;margin-top:.5rem;margin-bottom:1rem}.notebook-detail[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;color:#000;font-size:1rem;font-weight:700;margin-top:1rem;margin-bottom:1rem}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;height:calc(100vh - 300px);margin-top:1rem;border-radius:8px}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--header-search-bar-or-section-text-color);text-align:center}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]{margin-top:0}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-top:1.5rem}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;padding:.5rem 26px .5rem 24px;gap:.4rem;cursor:pointer;font-size:1rem;background-color:#1b494d68;border:none;border-radius:50px;color:#fff;box-shadow:0 2px 8px #0000004d}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]:hover{background-color:#777c7cdc}.notebook-detail[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]   iconify-icon[_ngcontent-%COMP%]{font-size:1.2rem}.notebook-detail[_ngcontent-%COMP%]   .notes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;padding:0;margin:0}"]})};export{ee as NotebookDetail};
