import{a as K}from"./chunk-DHPCAJSE.js";import{F as j,K as R,L as z,O as U,P as L,S as H,V as q,Y as G,Z as J,c as T,d as A,f as B,h as F,m as V,o as $}from"./chunk-HQ7FA72G.js";import{$ as S,Cb as b,Db as I,E as w,Fb as D,Nb as h,Oa as m,Ob as x,Ta as g,Za as E,_ as N,a as C,b as O,cb as f,k as y,ob as _,pa as d,pb as a,qa as p,qb as s,rb as u,sb as v,tb as k,ub as l,w as P,x as M}from"./chunk-MU7CWMHY.js";function X(i,t){i&1&&(a(0,"div",3),u(1,"i",4),b(2," Loading notebook... "),s())}function Y(i,t){i&1&&(a(0,"div",18)(1,"div",19),u(2,"i",20),s(),a(3,"h2"),b(4,"This notebook is empty"),s(),a(5,"p"),b(6,"Add some notes to get started!"),s()())}function Z(i,t){if(i&1){let e=v();a(0,"app-note",24),k("open",function(o){d(e);let r=l(3);return p(r.openNote(o))})("delete",function(o){d(e);let r=l(3);return p(r.deleteNote(o))})("togglePin",function(o){d(e);let r=l(3);return p(r.togglePin(o.note,o.event))})("optionSelected",function(o){let r=d(e).$implicit,c=l(3);return p(c.handleNoteOption(o,r))}),s()}if(i&2){let e=t.$implicit;_("note",e)("showNotebook",!1)}}function ee(i,t){if(i&1&&(a(0,"div",21)(1,"div",22),f(2,Z,1,2,"app-note",23),s()()),i&2){let e=l().ngIf,n=l();m(2),_("ngForOf",e.notes)("ngForTrackBy",n.trackByNoteId)}}function te(i,t){if(i&1){let e=v();a(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"h1",9),b(5),s(),a(6,"h2",10),b(7),s()(),a(8,"div",11)(9,"app-button-feature",12),k("clicked",function(){let o=d(e).ngIf,r=l();return p(r.editNotebook(o))}),s(),a(10,"app-button-feature",13),k("clicked",function(){let o=d(e).ngIf,r=l();return p(r.deleteNotebook(o))}),s(),a(11,"button",14),k("click",function(){d(e);let o=l();return p(o.navigateBack())}),u(12,"i",15),b(13," Close "),s()()()(),f(14,Y,7,0,"div",16)(15,ee,3,2,"div",17),s()}if(i&2){let e=t.ngIf;m(5),I(e.name),m(2),D(" ",e.notes.length," ",e.notes.length<=1?"NOTE":"NOTES"," "),m(7),_("ngIf",e.notes.length===0),m(),_("ngIf",e.notes.length>0)}}var Q=class i{constructor(t,e,n,o){this.route=t;this.router=e;this.store=n;this.eventBus=o}notebook$;allNotes$;notFound=!1;openNotebookOptionsId=null;destroy$=new y;ngOnInit(){this.allNotes$=this.store.select(q),this.notebook$=M([this.route.params,this.store.select(H),this.allNotes$]).pipe(P(([t,e,n])=>{let o=e.find(c=>c.id===t.id);if(!o&&e.length>0){this.notFound=!0;return}if(!o)return;let r=o.notes.map(c=>n.find(W=>W.id===c.id)||c).filter(c=>!!c);return console.log("Notebook found:",o.name),console.log("Notebook notes in data:",o.notes.length),console.log("Updated notes after sync:",r.length),O(C({},o),{notes:r})}),S(t=>{t&&console.log("Final notebook with notes:",t.notes.length)}),N(this.destroy$))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}trackByNoteId(t,e){return e.id}editNotebook(t){this.startEditingNotebook(t)}startEditingNotebook(t){this.openNotebookOptionsId=null,this.eventBus.emitNotebookEdit(t)}deleteNotebook(t){confirm(`Are you sure you want to delete "${t.name}"?`)&&(this.store.dispatch(L({id:t.id})),this.router.navigate(["/"]))}openNote(t){this.eventBus.emitNoteSelected(t)}removeNoteFromNotebook(t){confirm("Remove this note from the notebook?")&&this.notebook$.pipe(w(e=>!!e),N(this.destroy$)).subscribe(e=>{if(e){let n=e.notes.filter(o=>o.id!==t);this.store.dispatch(U({update:{id:e.id,changes:{notes:n}}}))}})}deleteNote(t){confirm("Are you sure you want to delete this note?")&&(this.removeNoteFromNotebook(t),this.store.dispatch(R({id:t})))}togglePin(t,e){e.stopPropagation(),this.store.dispatch(z({id:t.id}))}handleNoteOption(t,e){switch(console.log("Note option selected:",t,e.title),t){case"removeFromNotebook":this.removeNoteFromNotebook(e.id);break;case"delete":this.deleteNote(e.id);break;case"addToNotebook":this.eventBus.triggerAddToNotebookModal(e);break;default:console.log("Unknown action:",t)}}navigateBack(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||i)(g(V),g($),g(j),g(G))};static \u0275cmp=E({type:i,selectors:[["app-notebook-detail"]],decls:5,vars:6,consts:[[1,"notebook-detail-container"],["class","loading-state",4,"ngIf"],["class","notebook-detail",4,"ngIf"],[1,"loading-state"],[1,"bi","bi-arrow-clockwise"],[1,"notebook-detail"],[1,"notebook-header"],[1,"notebook-info"],[1,"notebook-info-items"],[1,"notebook-title"],[1,"section-title"],[1,"notebook-actions"],["customClass","notebook-action-button","icon","fluent:edit-28-regular","title","Edit Notebook",3,"clicked"],["customClass","notebook-action-button","icon","mage:trash","title","Delete Notebook",3,"clicked"],["title","Close Notebook",1,"notebook-close-button",3,"click"],[1,"mage:trash"],["class","empty-state",4,"ngIf"],["class","notes-section",4,"ngIf"],[1,"empty-state"],[1,"empty-icon"],[1,"bi","bi-journal-x",2,"font-size","3rem","color","#ccc"],[1,"notes-section"],[1,"notes-grid"],[3,"note","showNotebook","open","delete","togglePin","optionSelected",4,"ngFor","ngForOf","ngForTrackBy"],[3,"open","delete","togglePin","optionSelected","note","showNotebook"]],template:function(e,n){e&1&&(a(0,"div",0),f(1,X,3,0,"div",1),h(2,"async"),f(3,te,16,5,"div",2),h(4,"async"),s()),e&2&&(m(),_("ngIf",!x(2,2,n.notebook$)&&!n.notFound),m(2),_("ngIf",x(4,4,n.notebook$)))},dependencies:[F,T,A,B,K,J],styles:[".notebook-detail[_ngcontent-%COMP%]{position:relative;padding:2rem 4rem;width:calc(100% - 280px);margin-left:280px;margin-top:86px;box-sizing:border-box}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-info-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:0}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-actions[_ngcontent-%COMP%]{display:flex;gap:.8rem;align-items:center;justify-content:flex-start;opacity:1}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-actions[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]{padding:.5rem;cursor:pointer;font-size:1rem;width:8rem;background-color:var(--header-action-btn-main);border:none;border-radius:8px;color:#fff;box-shadow:0 2px 8px #0000004d}.notebook-detail[_ngcontent-%COMP%]   .notebook-info[_ngcontent-%COMP%]   .notebook-actions[_ngcontent-%COMP%]   .notebook-close-button[_ngcontent-%COMP%]:hover{background-color:#54a1a1;box-shadow:0 2px 16px #0000004d}.notebook-detail[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{align-items:center;color:var(--feature-button-color);font-size:small;font-weight:500;margin-top:.5rem;margin-bottom:1.5rem}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;height:calc(100vh - 240px);margin-top:1rem;border-radius:8px}.notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .notebook-detail[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--header-search-bar-or-section-text-color);text-align:center}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]{margin-top:0}.notebook-detail[_ngcontent-%COMP%]   .notes-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-top:1.5rem}.notebook-detail[_ngcontent-%COMP%]   .notes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;padding:0;margin:0}"]})};export{Q as NotebookDetail};
