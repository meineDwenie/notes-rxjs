import{q as H,r as W,s as q}from"./chunk-EKU5Z4EG.js";import{n as Q}from"./chunk-KBODP7Z6.js";import{i as D,m as R,o as L}from"./chunk-5IK5MZEV.js";import{Ab as C,Bb as u,Cb as s,Eb as A,Fb as F,Gb as z,Hb as j,Ib as E,J as S,Kb as _,La as N,Lb as k,Mb as O,Oa as r,Rb as T,Ta as y,Wb as U,Xb as B,Za as I,eb as m,pa as p,pb as f,qa as d,qb as V,rb as b,sb as $,ub as M,vb as P,w,wb as h,xb as a,yb as c,zb as x}from"./chunk-5VIB32CO.js";var G=["fileInput"],J=(n,o)=>o.id;function K(n,o){if(n&1&&(a(0,"div",18)(1,"span",19),_(2),c(),a(3,"span",20),_(4),c()()),n&2){let e=o.$implicit;E("completed",e.checked),r(2),k(e.checked?"\u2611":"\u2610"),r(),E("checked",e.checked),r(),k(e.text)}}function X(n,o){if(n&1&&(a(0,"div",17),_(1),c()),n&2){let e=s(2);r(),O("+",e.note.checkboxes.length-4," more")}}function Z(n,o){if(n&1&&(a(0,"div",3),M(1,K,5,6,"div",16,J),f(3,X,2,1,"div",17),c()),n&2){let e=s();r(),P(e.note.checkboxes.slice(0,4)),r(2),b(e.note.checkboxes.length>4?3:-1)}}function ee(n,o){if(n&1&&(a(0,"p"),_(1),c()),n&2){let e=s();r(),k(e.note.content)}}function te(n,o){if(n&1&&(a(0,"div",22),x(1,"img",24),c()),n&2){let e=s().$implicit;r(),h("src",e,N)}}function oe(n,o){if(n&1&&(a(0,"div",23),x(1,"img",24),a(2,"div",25),_(3),c()()),n&2){let e=s().$implicit,t=s(2);r(),h("src",e,N),r(2),O("+",t.length-3)}}function ne(n,o){if(n&1&&(f(0,te,2,1,"div",22),f(1,oe,4,2,"div",23)),n&2){let e=o.$index,t=s(2);b(e<2||t.length<=3?0:-1),r(),b(e===2&&t.length>3?1:-1)}}function ie(n,o){if(n&1&&(a(0,"div",21),M(1,ne,2,2,null,null,$),c()),n&2){let e=s();r(),P(e.slice(0,3))}}function re(n,o){n&1&&f(0,ie,3,0,"div",21),n&2&&b(o.length?0:-1)}function ae(n,o){if(n&1){let e=C();a(0,"app-button-feature",26),u("clicked",function(i){p(e);let l=s();return d(l.onAddCheckboxes(i))}),c()}}function ce(n,o){if(n&1){let e=C();a(0,"app-button-feature",27),u("clicked",function(i){p(e);let l=s();return d(l.onRemoveFromNotebook(i))}),c()}}function le(n,o){if(n&1){let e=C();a(0,"app-button-feature",28),u("clicked",function(i){p(e);let l=s();return d(l.onDelete(i))}),c()}}var Y=class n{constructor(o,e){this.store=o;this.eventBus=e;this.notebooks$=this.store.select(H)}note;open=new m;delete=new m;togglePin=new m;addToNotebook=new m;removeFromNotebook=new m;imageUpload=new m;showCheckboxes=new m;addCheckboxes=new m;triggerEdit=new m;fileInput;notebooks$;isInNotebook$;containingNotebook$;ngOnInit(){this.isInNotebook$=this.notebooks$.pipe(w(o=>o.some(e=>e.notes.some(t=>t.id===this.note.id)))),this.containingNotebook$=this.notebooks$.pipe(w(o=>o.find(e=>e.notes.some(t=>t.id===this.note.id))))}onOpen(){this.open.emit(this.note)}onDelete(o){o.stopPropagation(),this.delete.emit(this.note.id)}onTogglePin(o){this.togglePin.emit({note:this.note,event:o})}openAddToNotebookModal(o){this.eventBus.triggerAddToNotebookModal(o)}onRemoveFromNotebook(o){o.stopPropagation(),this.containingNotebook$.pipe(S(1)).subscribe(e=>{e&&this.removeFromNotebook.emit({noteId:this.note.id,notebookId:e.id})})}triggerImageUpload(o){o.stopPropagation(),this.fileInput.nativeElement.click()}onImageSelected(o){let e=o.target;if(e.files){let t=[],i=0,l=e.files.length;Array.from(e.files).forEach(g=>{let v=new FileReader;v.onload=()=>{typeof v.result=="string"&&t.push(v.result),i++,i===l&&this.imageUpload.emit({noteId:this.note.id,images:t})},v.readAsDataURL(g)}),e.value=""}}onAddCheckboxes(o){o?.stopPropagation(),this.eventBus.openNoteInEditMode(this.note,!0)}addCheckboxesToContent(o){return o.split(`
`).map(i=>i.trim()?`\u2610 ${i}`:i).join(`
`)}toggleCheckbox(o,e){let t=o.split(`
`);return t[e]&&(t[e].startsWith("\u2610")?t[e]=t[e].replace("\u2610","\u2611"):t[e].startsWith("\u2611")&&(t[e]=t[e].replace("\u2611","\u2610"))),t.join(`
`)}static \u0275fac=function(e){return new(e||n)(y(Q),y(W))};static \u0275cmp=I({type:n,selectors:[["app-note"]],viewQuery:function(e,t){if(e&1&&A(G,5),e&2){let i;F(i=z())&&(t.fileInput=i.first)}},inputs:{note:"note"},outputs:{open:"open",delete:"delete",togglePin:"togglePin",addToNotebook:"addToNotebook",removeFromNotebook:"removeFromNotebook",imageUpload:"imageUpload",showCheckboxes:"showCheckboxes",addCheckboxes:"addCheckboxes",triggerEdit:"triggerEdit"},decls:21,vars:14,consts:[["fileInput",""],[3,"click"],[1,"note-title",3,"title"],[1,"checkboxes-preview"],[1,"buttons-container",3,"click"],[1,"pin-icon"],[1,"bi",3,"click","ngClass","title"],["type","file","accept","image/*","multiple","",2,"display","none",3,"change"],[1,"left-buttons"],["customClass","image-button","icon","mage:image","title","Upload image",3,"clicked"],["customClass","add-to-notebook-button","icon","fluent:notebook-arrow-curve-down-20-regular","title","Add to notebook",3,"clicked"],["customClass","reminder-button","icon","carbon:reminder","title","Add reminder"],["customClass","add-checkboxes-button","icon","tabler:checkbox","title","Add checkboxes"],["customClass","archive-button","icon","mage:archive","title","Archive note"],["customClass","remove-from-notebook-button","icon","mdi:note-remove","title","Remove from notebook"],["customClass","delete-note-button","icon","mage:trash","title","Delete note"],[1,"checkbox-item",3,"completed"],[1,"more-checkboxes"],[1,"checkbox-item"],[1,"checkbox-icon"],[1,"checkbox-text"],[1,"image-preview"],[1,"image-wrapper"],[1,"image-wrapper","more-images-overlay"],[1,"preview-thumbnail",3,"src"],[1,"overlay"],["customClass","add-checkboxes-button","icon","tabler:checkbox","title","Add checkboxes",3,"clicked"],["customClass","remove-from-notebook-button","icon","mdi:note-remove","title","Remove from notebook",3,"clicked"],["customClass","delete-note-button","icon","mage:trash","title","Delete note",3,"clicked"]],template:function(e,t){if(e&1){let i=C();a(0,"li",1),u("click",function(){return p(i),d(t.onOpen())}),a(1,"div")(2,"h3",2),_(3),c(),f(4,Z,4,1,"div",3)(5,ee,2,1,"p"),f(6,re,1,1),c(),a(7,"div",4),u("click",function(g){return p(i),d(g.stopPropagation())}),a(8,"div",5)(9,"i",6),u("click",function(g){return p(i),d(t.onTogglePin(g))}),c()(),a(10,"input",7,0),u("change",function(g){return p(i),d(t.onImageSelected(g))}),c(),a(12,"div",8)(13,"app-button-feature",9),u("clicked",function(g){return p(i),d(t.triggerImageUpload(g))}),c(),a(14,"app-button-feature",10),u("clicked",function(){return p(i),d(t.openAddToNotebookModal(t.note))}),c(),x(15,"app-button-feature",11),f(16,ae,1,0,"app-button-feature",12),x(17,"app-button-feature",13),f(18,ce,1,0,"app-button-feature",14),U(19,"async"),V(20,le,1,0,"app-button-feature",15),c()()()}if(e&2){let i;j("background-color",t.note.color||"#ffffff"),r(2),h("title",T(t.note.title)),r(),k(t.note.title),r(),b(t.note.checkboxes&&t.note.checkboxes.length>0?4:5),r(2),b((i=t.note.images)?6:-1,i),r(3),h("title",T(t.note.pinned?"Unpin":"Pin"))("ngClass",t.note.pinned?"bi-pin-fill":"bi-pin"),r(7),b(!t.note.checkboxes||t.note.checkboxes.length===0&&t.note.content.trim()?16:-1),r(2),b(B(19,12,t.isInNotebook$)?18:20)}},dependencies:[L,D,R,q],styles:["li[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-radius:6px;min-height:280px;height:auto;padding:1rem;display:flex;flex-direction:column;justify-content:space-between;align-items:flex-start;cursor:default;overflow:visible;transition:all .2s ease;outline:.5px solid rgba(150,150,150,.3)}li[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #43868626;transform:translateY(-2px)}.note-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;line-height:1.3;width:95%;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;white-space:pre-wrap;font-family:Domine,serif}p[_ngcontent-%COMP%]{margin:0;font-size:15px;line-height:18pt;color:#343434;display:-webkit-box;-webkit-line-clamp:7;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;max-height:220px;white-space:pre-wrap}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{margin-top:0;cursor:default}.image-preview[_ngcontent-%COMP%]{display:flex;gap:6px;margin-top:.5rem}.image-preview[_ngcontent-%COMP%]   .image-wrapper[_ngcontent-%COMP%]   .preview-thumbnail[_ngcontent-%COMP%]{height:60px;width:auto;object-fit:cover;border-radius:4px}.buttons-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-top:1rem;opacity:0;pointer-events:auto;transition:opacity .2s ease-in-out;width:100%}li[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.left-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem}.pin-icon[_ngcontent-%COMP%]{position:absolute;top:14px;right:14px;padding:4px 6px 2px;cursor:pointer;font-size:1.2rem;color:var(--feature-button-color);z-index:10}.pin-icon[_ngcontent-%COMP%]:hover{color:var(--feature-button-hover-color);background-color:var(--feature-button-hover-background-color);border-radius:8px}.image-preview[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:flex-start;margin:1rem 0 0;gap:.5rem;width:auto;height:70%}.image-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;width:60px;height:60px;border-radius:4px;overflow:hidden}.preview-thumbnail[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:4px;border:1px solid #ccc;transition:transform .2s ease}.more-images-overlay[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#28282899;color:#fff;font-size:16px;font-weight:700;display:flex;justify-content:center;align-items:center;border-radius:4px}.loading-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;background-color:#f0f0f0;color:#666;font-size:12px;border-radius:8px}.remove-image-btn[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;width:20px;height:20px;border-radius:50%;background-color:#f44;color:#fff;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;z-index:10}.remove-image-btn[_ngcontent-%COMP%]:hover{background-color:#c33}input[type=file][_ngcontent-%COMP%]{display:none}.checkboxes-preview[_ngcontent-%COMP%]{padding:0;margin:0 0 .5rem}.checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.25rem;transition:opacity .2s ease}.checkbox-item.completed[_ngcontent-%COMP%]{opacity:.6}.checkbox-item.completed[_ngcontent-%COMP%]   .checkbox-text[_ngcontent-%COMP%]{text-decoration:line-through}.checkbox-icon[_ngcontent-%COMP%]{font-size:16px;flex-shrink:0;color:#666;line-height:1}.checkbox-text[_ngcontent-%COMP%]{font-size:14px;line-height:1.4;color:#2d3748;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;word-break:break-word;transition:all .2s ease}.checkbox-text.checked[_ngcontent-%COMP%]{text-decoration:line-through;opacity:.6;color:#888}.more-checkboxes[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-top:.25rem;font-style:italic}"]})};export{Y as a};
