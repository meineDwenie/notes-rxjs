import{q as z,r as L,s as R}from"./chunk-DTV7VGZ7.js";import{n as j}from"./chunk-5JRNSULR.js";import{i as F,j as $,k as A,m as B,o as D}from"./chunk-VGKXMW7M.js";import{Db as P,Eb as O,Hb as C,Ib as w,J as N,La as x,Oa as m,Ob as T,Sb as y,Ta as v,Tb as V,Vb as I,Za as E,cb as g,eb as a,pa as c,qa as p,qb as u,rb as i,sb as s,tb as f,ub as S,vb as M,w as h,wb as _,xb as d,yb as k}from"./chunk-AS2QI5Q4.js";function H(r,o){if(r&1&&(i(0,"div",16),f(1,"img",17),s()),r&2){let e=o.$implicit;m(),u("src",e,x)}}function W(r,o){if(r&1&&(i(0,"div",14),g(1,H,2,1,"div",15),s()),r&2){let e=k();m(),u("ngForOf",e.note.images)}}function Y(r,o){if(r&1){let e=_();S(0),i(1,"app-button-feature",18),d("clicked",function(n){c(e);let l=k();return p(l.onRemoveFromNotebook(n))}),s(),M()}}function q(r,o){if(r&1){let e=_();i(0,"app-button-feature",19),d("clicked",function(n){c(e);let l=k();return p(l.onDelete(n))}),s()}}var U=class r{constructor(o,e){this.store=o;this.eventBus=e;this.notebooks$=this.store.select(z)}note;open=new a;delete=new a;removeFromNotebook=new a;togglePin=new a;optionSelected=new a;addToNotebook=new a;showCheckboxes=new a;addCheckboxes=new a;notebooks$;isInNotebook$;containingNotebook$;dropdownVisible=!1;ngOnInit(){this.isInNotebook$=this.notebooks$.pipe(h(o=>o.some(e=>e.notes.some(t=>t.id===this.note.id)))),this.containingNotebook$=this.notebooks$.pipe(h(o=>o.find(e=>e.notes.some(t=>t.id===this.note.id))))}onOpen(){this.open.emit(this.note)}onDelete(o){o.stopPropagation(),this.delete.emit(this.note.id)}onRemoveFromNotebook(o){o.stopPropagation(),this.containingNotebook$.pipe(N(1)).subscribe(e=>{e&&this.removeFromNotebook.emit({noteId:this.note.id,notebookId:e.id})})}onTogglePin(o){this.togglePin.emit({note:this.note,event:o})}openAddToNotebookModal(o){this.eventBus.triggerAddToNotebookModal(o)}onOptionSelected(o){switch(o){case"addToNotebook":this.optionSelected.emit("addToNotebook"),this.addToNotebook.emit(this.note);break;case"delete":this.onDelete({stopPropagation:()=>{}});break;case"showCheckboxes":this.showCheckboxes.emit(this.note);break;case"addCheckboxes":this.addCheckboxes.emit(this.note);break}}addCheckboxesToContent(o){return o.split(`
`).map(n=>n.trim()?`\u2610 ${n}`:n).join(`
`)}toggleCheckbox(o,e){let t=o.split(`
`);return t[e]&&(t[e].startsWith("\u2610")?t[e]=t[e].replace("\u2610","\u2611"):t[e].startsWith("\u2611")&&(t[e]=t[e].replace("\u2611","\u2610"))),t.join(`
`)}static \u0275fac=function(e){return new(e||r)(v(j),v(L))};static \u0275cmp=E({type:r,selectors:[["app-note"]],inputs:{note:"note"},outputs:{open:"open",delete:"delete",removeFromNotebook:"removeFromNotebook",togglePin:"togglePin",optionSelected:"optionSelected",addToNotebook:"addToNotebook",showCheckboxes:"showCheckboxes",addCheckboxes:"addCheckboxes"},decls:20,vars:12,consts:[["deleteButton",""],[3,"click"],[1,"note-title"],["class","image-preview",4,"ngIf"],[1,"buttons-container",3,"click"],[1,"pin-icon"],[1,"bi",3,"click","ngClass","title"],[1,"left-buttons"],["customClass","image-button","icon","mage:image","title","Upload image"],["customClass","add-to-notebook-button","icon","fluent:notebook-arrow-curve-down-20-regular","title","Add to notebook",3,"clicked"],["customClass","reminder-button","icon","carbon:reminder","title","Add reminder"],["customClass","add-checkboxes-button","icon","tabler:checkbox","title","Add checkboxes",3,"clicked"],["customClass","archive-button","icon","mage:archive","title","Archive note"],[4,"ngIf","ngIfElse"],[1,"image-preview"],["class","image-wrapper",4,"ngFor","ngForOf"],[1,"image-wrapper"],[1,"preview-thumbnail",3,"src"],["customClass","remove-from-notebook-button","icon","mdi:note-remove","title","Remove from notebook",3,"clicked"],["customClass","delete-note-button","icon","mage:trash","title","Delete note",3,"clicked"]],template:function(e,t){if(e&1){let n=_();i(0,"li",1),d("click",function(){return c(n),p(t.onOpen())}),i(1,"div")(2,"h3",2),C(3),s(),i(4,"p"),C(5),s(),g(6,W,2,1,"div",3),s(),i(7,"div",4),d("click",function(b){return c(n),p(b.stopPropagation())}),i(8,"div",5)(9,"i",6),d("click",function(b){return c(n),p(t.onTogglePin(b))}),s()(),i(10,"div",7),f(11,"app-button-feature",8),i(12,"app-button-feature",9),d("clicked",function(){return c(n),p(t.openAddToNotebookModal(t.note))}),s(),f(13,"app-button-feature",10),i(14,"app-button-feature",11),d("clicked",function(b){return c(n),p(t.onDelete(b))}),s(),f(15,"app-button-feature",12),g(16,Y,2,0,"ng-container",13),y(17,"async"),g(18,q,1,0,"ng-template",null,0,I),s()()()}if(e&2){let n=P(19);O("background-color",t.note.color||"#ffffff"),m(3),w(t.note.title),m(2),w(t.note.content),m(),u("ngIf",t.note.images==null?null:t.note.images.length),m(3),u("title",T(t.note.pinned?"Unpin":"Pin"))("ngClass",t.note.pinned?"bi-pin-fill":"bi-pin"),m(7),u("ngIf",V(17,10,t.isInNotebook$))("ngIfElse",n)}},dependencies:[D,F,$,A,B,R],styles:["li[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-radius:6px;min-height:280px;height:auto;padding:1rem;display:flex;flex-direction:column;justify-content:space-between;align-items:flex-start;cursor:default;overflow:visible;transition:all .2s ease;outline:.5px solid rgba(150,150,150,.3)}li[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #43868626;transform:translateY(-2px)}p[_ngcontent-%COMP%]{margin:0;font-size:15px;line-height:18pt;color:#343434;display:-webkit-box;-webkit-line-clamp:7;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;max-height:220px;white-space:pre-wrap}.image-preview[_ngcontent-%COMP%]{display:flex;gap:6px;margin-top:.5rem}.image-preview[_ngcontent-%COMP%]   .image-wrapper[_ngcontent-%COMP%]   .preview-thumbnail[_ngcontent-%COMP%]{height:60px;width:auto;object-fit:cover;border-radius:4px}.buttons-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-top:1rem;opacity:0;pointer-events:auto;transition:opacity .2s ease-in-out;width:100%}li[_ngcontent-%COMP%]:hover   .buttons-container[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.left-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem}.pin-icon[_ngcontent-%COMP%]{position:absolute;top:14px;right:14px;padding:4px 6px 2px;cursor:pointer;font-size:1.2rem;color:var(--feature-button-color);z-index:10}.pin-icon[_ngcontent-%COMP%]:hover{color:var(--feature-button-hover-color);background-color:var(--feature-button-hover-background-color);border-radius:8px}"]})};export{U as a};
